{% extends 'base.html' %}

{% block title %}
–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
{% endblock %}

{% block style %}
  .hover-wrapper {
      position: relative;
      cursor: pointer;
    }
    .hover-card {
      position: absolute;
      top: 50%;            /* drop below the cell text  */
      left: 100%;
      z-index: 9;        /* above table borders       */
      display: none;
      width: 240px;
    }
    .hover-wrapper:hover .hover-card,
    .hover-wrapper:focus .hover-card {
      display: block;
    }
{% endblock %}

{% block body %}
<div class="container-fluid mt-4 mb-5">
  <h1 class="mb-4">–ì–ª–∞–≤–Ω—ã–π –ø—Ä–∞–π—Å</h1>

  <div class="row">
    <!-- –ë–ª–æ–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
    <div class="col-md-3">
      <form method="get" class="card p-3 shadow-sm">
        <h5 class="mb-3">–§–∏–ª—å—Ç—Ä—ã</h5>

        <!-- –ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –ø–æ–ª—è–º -->
        {% for item in filter.form %}
        <div class="container">
          <h5>{{item.label}}</h5>
          <div class="mb-r  overflow-auto" style="max-height: 5cm;">
            {{ item}}
          </div>
        </div>
        {%endfor%}

        {% if available_suppliers %}
        <div class="mt-4">
          <h6 class="mb-2">–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏ ({{ available_suppliers|length }})</h6>
          <div class="d-flex flex-wrap gap-2">
            {% for supplier in available_suppliers %}
            <span class="badge text-bg-light border text-wrap">{{ supplier }}</span>
            {% endfor %}
          </div>
        </div>
        {% endif %}

        {% if available_manufacturers %}
        <div class="mt-4">
          <h6 class="mb-2">–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏ ({{ available_manufacturers|length }})</h6>
          <div class="d-flex flex-wrap gap-2">
            {% for manufacturer in available_manufacturers %}
            <span class="badge text-bg-light border text-wrap">{{ manufacturer }}</span>
            {% endfor %}
          </div>
        </div>
        {% endif %}

        <!-- –ö–Ω–æ–ø–∫–∏ -->
        <div class=" d-flex gap-2 mt-5">
          <button type="submit" class="btn btn-primary">
            üîç –ò—Å–∫–∞—Ç—å
          </button>
          <a href="{% url 'main-product-sync'%}" class="btn btn-success">
            <i class="bi bi-recycle"></i> –û–±–Ω–æ–≤–∏—Ç—å
          </a>
        </div>
      </form>
    </div>

    <!-- –¢–∞–±–ª–∏—Ü–∞ -->
    <div class="col-md-9 mb-5">
      {% load export_url from django_tables2 %}

      <div class="table-responsive card p-3 shadow-sm overflow-visible">
        {% load django_tables2 %}
        {% render_table table %}
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block script %}
<script>
  document.body.addEventListener('htmx:configRequest', (evt) => {
    evt.detail.headers['X-CSRFToken'] = '{{ csrf_token }}';
  });
</script>
{% endblock %}
